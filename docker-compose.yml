---
version: "3.9"
services:
  bed-socket:
    image: bn_adjustable_bed:latest
    entrypoint: /venv/bin/bn-bed-socket
    environment:
      - REDIS_HOST=redis
    depends_on:
      - redis
    ports:
      - "23778"
    restart: unless-stopped
  controller-api:
    image: bn_adjustable_bed:latest
    entrypoint: /venv/bin/bn-controller-api
    environment:
      - REDIS_HOST=redis
    depends_on:
      - redis
      - bed-socket
    ports:
      - "8080:80"
    restart: unless-stopped
  app-api:
    image: bn_adjustable_bed:latest
    entrypoint: /venv/bin/bn-app-api
    environment:
      - REDIS_HOST=redis
    depends_on:
      - redis
    ports:
      - "80"
    restart: unless-stopped
  redis:
      image: redis:6
      ports:
        - "6379"
      restart: unless-stopped
